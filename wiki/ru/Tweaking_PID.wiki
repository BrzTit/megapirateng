#summary Copter_Tweaks .
#labels ардукоптер, мегапират, настройка пидов, настройка PID, описание PID
<g:plusone size="medium"></g:plusone>
= Настройка PID параметров ардукоптера =
Настройки Pid и что означают PId для Arducopter (перевод из wiki arducopter)

Если Вы истпользуете раму, отличную от официального ArduCopter kit (набора) , Вам понадобится изменять некоторые PID параметры
(PID означает Proportional-Integral-Derivative Пропорционально-Интегральная производная. Вы можете прочесть об этом больше [http://en.wikipedia.org/wiki/PID_controller здесь])

Полное описание PID ниже:


Вы можете регулировать ПИДы в Mission Planner 

http://wiki.ardupilot-mega.googlecode.com/git/images/planner_pid.png

=Помните две вещи:=

1. Начните с использования Stabilize режима для настроек. Если ЭТО не полетит корректно в Stabilize ОНО НЕ ПОЛЕТИТ нормально ни в одном другом режиме.

2. Сначала начните с дефолтных настроек (настройки по умолчанию). Вы не должны сразу сильно менять настройки от дефолтных.

Для нормального полета , есть действительно только один параметр , о котором бы должны "позаботиться" - это Rate Roll P setting (Rate Pitch по умолчанию связан с ним , если нажата галочка "Lock Pitch and Roll Values" смотрите картинку выше)
Повышая это значение делаете коптер более "агрессивним" в полете . Понижая это значение Вы получаете более "мягкий " отклик.

{{{
 Вот пример: по умолчанию значение Rate Roll P - 0.14. Это значение оптимально для стандартного Jdrones/3DR
квадрокоптера с 850 моторами и 10" (10 дюймовыми) пропеллерами. Однако если Вы используете большие чем 
850 моторы и 12 дюймовые пропеллеры , которые более мощные, то такие значения Rate Roll P будут слишком
агрессивные и Ваш квадрик будет казаться довольно неустойчивым. Так в этом случае понизьте ваши значения 
Rate Roll P до 0.1 или 0.09, и вы должны увидеть более стабильный полет.
То же самое верно и для удержания высоты - Altitude hold. Throttle Rate P нуждается в корректировке,
 чтобы получить оптимальную производительность по высоте. 
}}}

Эти 2 параметра нужно подбирать , чтобы заставить ваш коптер хорошо отрабатывать, и сильно зависят от соотношения тяга/вес вашего коптера. Больше тяги - меньше значения.

*Мой коптер раскачивается медленно (большие движения) когда стабилизировался :* понизьте значение в Stabilize Roll P.

*Мой коптер раскачивается быстро (мелкие движения) когда стабилизировался :* понизьте значение Rate Roll P.

*Мой коптер становится шатким при быстрой посадке .* Поднимите значение Rate Roll P. Не всегда получается - зависит от пропов.

*Мой коптер слишком вялый :* Понимите значение Stabilize Roll P. Это значение заставляет коптер быстрее реагировать на угловые ошибки.

*Мой вертолет крутит вправо или влево на 15 °, когда я взлетаю:* Ваши моторы установлены не прямо или Регули не откалиброваны.

*После агрессивного полета  мой квадрокоптер наклоняется в одну сторону 10 - 30 °:* Убедитесь, что перемычки на  фильтре низких частот 
на APM припаяны на IMU, как показано здесь. (для оригинальной платы - нам похоже без надобности)
Сделайте все что вы можете, чтобы удалить вибрации и изолировать APM. Вы даже можете попробовать и добавить небольшой вес на APM,
чтобы она не вибрировала. Кроме того, можно просто  приземлиться  на нескольких секунд, а затем продолжить полет, это даст APM шанс избавиться от вибрации.

*Мой вертолет не хочет висеть неподвижно в воздухе:* Выполнить команду уровень (Level) на плоской поверхности. (удерживать разоружиться - правый стик вправо - в течение 15 секунд для запуска.) 
Вы также можете летать в auto-trim режиме  в безветренную (важно!) погоду. Любой ветер будет вызывать изменения, которые будут работать против вас, когда квадрокоптер поворачивается на 180 °.
Вы можете использовать свои  радио Pitch и Roll триммирование, но помните, повторно re-centre ич при настройке вашего радио с конфигурацией инструментов. 
Использование радио триммирования может иметь негативный эффект в Simple режиме, при рысканьи (кручении). Никогда не триммируйте YAW, Ваш вертолет может начать вращаться по себе.
(Квадрокоптеры также восприимчивы к drafts (_проектам?, сквознякам?_). Они будут нуждаться в постоянной корректировке, если вы установите оптический датчик потока. однажды ...:-))

*Мой квадрокоптер летает хорошо, но потом сваливается на один двигатель (луч) (_суетливо, беспокойно_) при наведении:* Ваш двигатель может плохо работает или виноваты разъемы между двигателем и ESC (регулятором).
Вибрация от  вала или несбалансированного пропеллера может заставить разъем на мгновение отключить двигатель (проверьте разъем). Двигателю с плохим подшипником требуется больше мощности. ESC (регулятор) может
отсекать мощность, чтобы защитить себя. Или, может быть, летать достаточно медленно, чтобы остановить двигатель.
Прикрепите датчик тока (амперметр) между аккумулятором и двигателем и протестируйте разница между хорошим двигателем и плохим. Если вы видите выше показания в плохом, замените или исправьте. 
 

*Мой вертолет внезапно упал без уважительной причины:*  I2C порт, используемый для соединения с компасом, имеет редкое, но очень серьезный недостаток, который будет блокировать выполнение кода.
Чтобы избежать любых вопросов, не забудьте припаять компас надежно.

 
*В Loiter, мой вертолет постоянно промазывает (перелетает):* Попробуйте и увеличить Nav_P параметр. Вы также можете настроить работу *I* параметров, потому что в некоторых случаях, Nav_I или Loiter_I может вызывать перелет.
Установка *I* параметра в 0, когда ветранно -  лучший способ настроить Nav_P. 


*Удержание высоты  выше 10 футов (3 метров) происходит лишь с 1-2м точностью:* Это действительно лучшее, что вы можете достичь. Датчик баро чувствителен к свету и ветру. Прикройте его крышкой для защиты от ветра и убедитесь, что вы не заклеили отверстия и запечатать его. 


*Мой вертолет больше и больше плавает вверх-вниз, в Alt-HOLD. Это в конечном итоге приводит  к падению :* Ваш THROTTLE_P слишком высок или низок. Вам не нужен большой *P*, чтобы сделать ALT-HOLD. Подумайте, насколько вы перемещаете стик газа  чтобы удерживать высоту 
Не на много! Это то, каким нужно  делать *P*. *I* будет наращиваться (суммироваться), так как ваши батареи разряжаются, чтобы компенсировать разницу.

 
*Я  установил сонар, но не могу заставить его работать: * На ваш сонар могут наводиться электрические помехи от регуляторов.Переместите переместить его в несколькио дюймов от любого ESC  (регулятора) и попытайтесь экранировать кабель, если это возможно.
Если на улице холодно, ваш сонар может перестать работать.


*Мой квадрик медленно вращается за или против часовой стрелки :* Отрегулируйте  склонение вашего компаса (в настройках компаса declination - зависит от географического положения) пока не перестанет кружить.
 
 
 =In-flight tuning  Настройки в полете=
 //пока пропущено...


=За что отвечают Пиды .=

Что означает...

*STABILIZE_P:* скорость поворачивания (реагирования) , с которой Вы хотите, чтобы реагировал коптер. Чем выше тем быстрее коптер будет пытаться достичь желаемой позиции.

*STABILIZE_I:* Используется для учета изменений CG (кто знает что это такое), слабые двигатели или постоянные внешние силы.

*STABILIZE_Imax:* Максимальное количество, что коптер может компенсировать эти несбалансированные силы.



*RATE_P:* _*самый важный параметр!*_ Его значение контролирует, сколько тяги нужно выводить для достижения желаемой скорости вращения.
Большая тяга (мощные двигатели) или большой вес коптеров потребуется меньшее значение RATE_P, меньшая тяга / вес потребует более высокое значение.
Слишком высокие значения будут вызывать колебания около 5-10Гц. Вам нужно, чтобы это значение было несколько ниже, чем значение, котороя вызывает колебание.
Агрессивный тюнинг можно получить вернув ровно на 1 от значения перерегулирования . Используйте CH6 настройки для регулировки в воздухе для лучшей производительности.

*RATE_I:* Используется, чтобы помочь коптеру достичь желаемого крена . Не используйте значение по умолчанию, как это может быть очень трудно настроиться должным образом и может ввести в заблуждение.
Если вы только начинаете, установить этот параметр в 0.

*RATE_IMAX:* максимальное количество Rate_I, которые могут накапливаться. Также не используйте по умолчанию. Имея в 0 IMAX сделает Rate_I совершенно неэффективными, независимо от того, насколько высок Rate_I .



*YAW* используется для положения под определенным углом рыскания. Если ваш коптер хочет крутиться, естественно, вы не сможете задать точное направление.
Вы будете дрифтовать, а не поворачивать на несколько градусов, пока P получится значительно высоким, чтобы остановить вращение.

*STABILIZE_YAW_P:* Заданная скорость, с которой вертолет повернется к нужному направлению. Если он слишком высокой, это может вызвать колебания.

*STABILIZE_YAW_I:* Действует как триммирование для преодоления плохого баланса коптера. Определяет время, необходимое для достижения максимального значения. Выше = быстрее.

*RATE_YAW_P:* Используется в качестве контролирующего органа AC2 можно использовать для достижения нулевой скорости рыскания. Если он слишком низкий, вы никогда не будете в состоянии остановить вращение. Если он слишком высокий, вызовет колебания рыскания.

*RATE_YAW_I:* не используется


//пропущено...


*Throttle Rate* используется чтобы ослабить коптер и контролировать скорость подъема.

*Throttle Rate P* : количество газа на выходе используется для изменения скорости подъема.

*THROTTLE_I:* компенсирует ошибки в достижении желаемой скорости подъема (ноль по умолчанию. мы используем Alt hold делать большую часть работы.).

*THROTTLE_IMAX:* Количество Throttle_I мы можем добавить или убрать для достижения желаемой скороподъемности.
